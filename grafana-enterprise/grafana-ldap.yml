apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-ldap
  namespace: grafana-enterprise
data:
  ldap.toml: |-  
    [[servers]]
    host = "openldap.openldap.svc.cluster.local"
    port = 389
    use_ssl = false
    start_tls = false
    ssl_skip_verify = true
    

    # Search user bind dn
    bind_dn = "cn=admin,dc=example,dc=org"
    # Search user bind password
    # If the password contains # or ; you have to wrap it with triple quotes. Ex """#password;"""
    bind_password = 'admin'

    # User search filter, for example "(cn=%s)" or "(sAMAccountName=%s)" or "(uid=%s)"
    search_filter = "(cn=%s)"

    # An array of base dns to search through
    search_base_dns = ["dc=example,dc=org"]

    # Specify names of the ldap attributes your ldap uses
    [servers.attributes]
    name = "givenName"
    surname = "sn"
    username = "cn"
    member_of = "DN"
    email =  "mail"

    # Map ldap groups to grafana org roles
    [[servers.group_mappings]]
    group_dn = "cn=Admins,ou=Groups,dc=example,dc=org"
    org_role = "Admin"
    grafana_admin = true
    org_id = 1

    [[servers.group_mappings]]
    group_dn = "cn=Maintainers,ou=Groups,dc=example,dc=org"
    org_role = "Editor"

    [[servers.group_mappings]]
    # If you want to match all (or no ldap groups) then you can use wildcard
    group_dn = "*"
    org_role = "Viewer"

